<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Screenshot App</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="main-wrapper">
    <div class="toolbar">
      <div class="button-group hidden" id="mediaButtonsGroup">
        <button class="control-button" id="screenshotBtn">Take Screenshot</button>
        <button class="control-button" id="videoBtn">Video</button>
        <button class="control-button" id="video2">Video 2</button>
        <button class="control-button" id="popOutWSButton">Pop Out WS</button>
        
        <fieldset>
          <legend>Mouse Control</legend>
          <div class="coord-inputs">
            <input type="text" id="x-coord" class="coord-input"
                   placeholder="X"
                   pattern="-?[0-9]+"
                   title="Please enter a valid coordinate value."
                   oninput="this.value = this.value.replace(/[^-0-9]/g, '')" required>
            <input type="text" id="y-coord" class="coord-input"
                   placeholder="Y"
                   pattern="-?[0-9]+"
                   title="Please enter a valid coordinate value."
                   oninput="this.value = this.value.replace(/[^-0-9]/g, '')" required>
            <button class="control-button" id="sendMouseInput">Move</button>
            <button class="control-button" id="sendMouseClick">Click</button>
          </div>
        </fieldset>
      </div>

      <fieldset>
        <legend>Connection</legend>
        
        <!-- Debug Button positioned at top right -->
        <button class="debug-button" id="toggleButtonsBtn" title="Debug"></button>
        
        <!-- FPS Selection -->
        <div class="fps-selector" style="margin-bottom: 10px;">
          <label style="display: block; margin-bottom: 4px; font-size: 12px; color: #6f6f6f;">FPS</label>
          <div class="fps-buttons" style="display: flex; gap: 4px; height: 20px;">
            <button class="fps-button" data-fps="1">1</button>
            <button class="fps-button" data-fps="5">5</button>
            <button class="fps-button" data-fps="10">10</button>
            <button class="fps-button" data-fps="15">15</button>
            <button class="fps-button" data-fps="30">30</button>
          </div>
        </div>

        <div class="input-group">
          <input type="text" id="ipv4" class="dark-textarea" 
                 placeholder="IP Address" 
                 pattern="^(?:[0-9]{1,3}\.){3}[0-9]{1,3}$|^[\da-fA-F:]+$"
                 oninput="this.value=this.value.replace(/[^0-9a-fA-F.:]/g,'')" required>
          <button class="control-button" id="setTargetIP">Connect</button>
        </div>
        
      </fieldset>

      <fieldset>
        <legend>Status</legend>
        <p style="margin: auto; font-size: 12px; padding: 5px; width: fit-content;">Total tokens used: <span id="tokenCounter">0</span></p>
        <p style="margin: auto; font-size: 12px; padding: 5px; width: fit-content;">Total network data usage: <span id="networkCounter">0</span></p>
      </fieldset>

      <div id="tasksSection" class="tasks-section">
        <fieldset>
          <legend>Tasks</legend>
          <div id="tasksContainer"></div>
        </fieldset>
      </div>

      <fieldset id="chatFieldset" style="flex: 3; display: flex; flex-direction: column; min-height: 200px;" class="chat-fieldset">
        <legend>Chat</legend>
        <div class="chat-header">
          <button class="settings-button" id="settingsBtn">Settings</button>
          <div id="selectedSessionIp" class="selected-session-ip" style="display: none;">Session: <span id="selectedIpText"></span></div>
        </div>
        <textarea id="llmChatInput" class="dark-textarea" placeholder="Type a message..." spellcheck="false" autocorrect="off" autocapitalize="off" autocomplete="off"></textarea>
        <button class="control-button" id="llmSendButton" style="margin-top: 10px;">Send</button>
      </fieldset>
    </div>

    <div class="main-content" id="mainContent" data-session-count="0">
      <!-- Session containers will be dynamically added here -->
    </div>
    
    <!-- Connection overlay for drawing lines between chat and sessions -->
    <div class="connection-overlay" id="connectionOverlay">
      <svg width="100%" height="100%" id="connectionSvg"></svg>
    </div>
  </div>

  <!-- Toast notification container -->
  <div class="toast-container" id="toastContainer"></div>

  <script src="script.js"></script>
</body>
</html>
